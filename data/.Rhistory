library(rcarbon)
library(here)
library(here)
source(here('src','sampleCounts.R'))
x = read.csv(here('oxcalresults','MCMC_uniform.csv'))
View(x)
x = x[,-c(1,ncol(x))] # eliminate pass number and last column
cntMatrix = sampleCounts(x) #this will take a couple of minutes
png(file=here('figures','testPlot.png'),width = 480,height=480)
plotCntMat(cntMatrix)
dev.off()
x = read.csv(here('oxcalresults','MCMC_uniform_rerun.csv'))
x = x[,-c(1,ncol(x))] # eliminate pass number and last column
cntMatrix = sampleCounts(x) #this will take a couple of minutes
png(file=here('figures','testPlot1.png'),width = 480,height=480)
plotCntMat(cntMatrix)
dev.off()
library(rcarbon)
library(doParallel)
library(here)
setwd("C:\\Users\\Usuario\\Downloads\\BayesMegaliths-master\\data")
# Load data
dates = read.csv("C14dates_Iberia.csv", header = T, sep=";")
# Calibrate dates
dates_cal<- calibrate(x=dates$C14,
errors=dates$STD, normalised=FALSE,
calMatrix=TRUE)
# Create the bin-width (here h = 100)
bin_width <- binPrep(sites=as.character(dates$Site),
ages=dates$C14, h=100)
# Setup SPD limits, computer cores and number of simulations
start_sumprob <- 9000
end_sumprob <- 2000
cores <- detectCores()
cores_utils <- 6
nsim=5000
Iberia_exp_h100_rec <-readRDS("C:\\Users\\Usuario\\Downloads\\BayesMegaliths-master\\data\\Iberia_SPD.rds", refhook = NULL)
plot(Iberia_exp_h100, xlim=c(9000, 2000))
pan <-layout(matrix(c(1,1,2,2), ncol=2, byrow=TRUE), heights=c(4, 1))
par(mai=rep(0.64, 4))
layout.show(pan)
plot(Iberia_exp_h100, xlim=c(9000, 2000))
lines(Iberia_exp_h100$fit$calBP,Iberia_exp_h100$result$PrDens, type = "l", col="blue")
lines(Iberia_exp_h100$fit$calBP,Iberia_exp_h100$fit$PrDens,type="l",lty=2,col="red")
# insert plot title
title("Iberia SPD based on exponentinal null model")
mtext("null model: p.value < 0.001", side = 3, line = 0.25, cex = 0.80)
#insert legend
par(mai=c(0,0,0,0))
plot.new()
# panel.first = grid()
legend(x="center", ncol=5,legend=c("SPD","Conf. Interval", "Null model", "positive dev.","negative dev."),
col =c("blue","lightgrey","red","indianred","royalblue"),lty=c(1,1,2,1,1),
lwd=c(1,5,1,5,5),cex=0.72,xjust = -2)
plot(Iberia_exp_h100_rec, xlim=c(9000, 2000))
pan <-layout(matrix(c(1,1,2,2), ncol=2, byrow=TRUE), heights=c(4, 1))
par(mai=rep(0.64, 4))
layout.show(pan)
plot(Iberia_exp_h100_rec, xlim=c(9000, 2000))
lines(Iberia_exp_h100$fit$calBP,Iberia_exp_h100$result$PrDens, type = "l", col="blue")
lines(Iberia_exp_h100$fit$calBP,Iberia_exp_h100$fit$PrDens,type="l",lty=2,col="red")
# insert plot title
title("Iberia SPD based on exponentinal null model")
mtext("null model: p.value < 0.001", side = 3, line = 0.25, cex = 0.80)
#insert legend
par(mai=c(0,0,0,0))
plot.new()
# panel.first = grid()
legend(x="center", ncol=5,legend=c("SPD","Conf. Interval", "Null model", "positive dev.","negative dev."),
col =c("blue","lightgrey","red","indianred","royalblue"),lty=c(1,1,2,1,1),
lwd=c(1,5,1,5,5),cex=0.72,xjust = -2)
?png
tiff(file=here('figures','SPD_Plot.tiff'),width = 800,height=461)
png(file=here('figures','SPD_Plot.png'),width = 800,height=461)
png(file=here('figures','SPD_Plot.png'),width = 800,height=461)
